RUNTIME = ::boot:ocamlrun
COMPILER = ::ocamlc
CAMLC = {RUNTIME} {COMPILER}
CAMLDEP = ::boot:ocamlrun ::tools:ocamldep

OBJS = pervasives.cmo list.cmo char.cmo string.cmo array.cmo sys.cmo ¶
  hashtbl.cmo sort.cmo filename.cmo marshal.cmo obj.cmo ¶
  lexing.cmo parsing.cmo ¶
  set.cmo map.cmo stack.cmo queue.cmo stream.cmo ¶
  buffer.cmo printf.cmo format.cmo arg.cmo printexc.cmo gc.cmo ¶
  digest.cmo random.cmo oo.cmo genlex.cmo callback.cmo weak.cmo ¶
  lazy.cmo

all Ä stdlib.cma std_exit.cmo camlheader camlheader_ur

install Ä
    duplicate -y stdlib.cma std_exit.cmo Å.cmi Å.mli camlheader camlheader_ur ¶
	          "{LIBDIR}"

stdlib.cma Ä {OBJS}
    {CAMLC} -a -o stdlib.cma {OBJS}

camlheader Ä
    (quote -n "{BINDIR}ocamlrun"; ¶
	 echo ' "{command}" {"Parameters"}; exit {status}') ¶
	> camlheader

camlheader_ur Ä
	echo -n ' ' >camlheader_ur

clean ÄÄ
    delete -i camlheader camlheader_ur

pervasives.cmi Ä pervasives.mli
    {CAMLC} {COMPFLAGS} -nopervasives -c pervasives.mli

pervasives.cmo Ä pervasives.ml
    {CAMLC} {COMPFLAGS} -nopervasives -c pervasives.ml

# oo.cmi must be compiled with -nopervasives for applets
oo.cmi Ä oo.mli
	{CAMLC} {COMPFLAGS} -nopervasives -c oo.mli

.cmi Ä .mli
    {CAMLC} {COMPFLAGS} -c {default}.mli

.cmo Ä .ml
    {CAMLC} {COMPFLAGS} -c {default}.ml

{OBJS} std_exit.cmo Ä pervasives.cmi

clean ÄÄ
    delete -i Å.cm[aio] || set status 0

depend Ä
    {CAMLDEP} Å.mli Å.ml > Makefile.Mac.depend
